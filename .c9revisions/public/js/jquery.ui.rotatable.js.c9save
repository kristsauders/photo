{"ts":1367352289353,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1367352251169,"patch":[[{"diffs":[[1,"/*!\n * jQuery Element Rotation Plugin\n *\n * Requires jQueryUI \n *\n * Copyright (c) 2010 Pavel Markovnin\n * Dual licensed under the MIT and GPL licenses.\n *\n * Extended by Trevor Wistaff\n *\n * http://vremenno.net\n */\n\n(function ($) {\n  'use strict';\n\n  $.fn.rotatable = function (options) {\n\n    // Default Values\n    var defaults = {\n      rotatorClass: 'ui-rotatable-handle',\n      mtx: [1, 0, 0, 1],\n      autoHide: true\n    }, opts = $.extend(defaults, options),\n      _this = this,\n      _rotator, center_coords, dims;\n\n    // Initialization \n    this.initialize = function () {\n      this.createHandler();\n\n      dims = {\n        'w': _this.width(),\n        'h': _this.height()\n      };\n\n      this.updateRotationMatrix(opts.mtx);\n    };\n\n    // Create Rotation Handler\n    this.createHandler = function () {\n      _rotator = $('<div class=\"' + opts.rotatorClass + '\"></div>');\n      _this.append(_rotator);\n      _this.rotating = false;\n\n      if(opts.autoHide) {\n        $(_this).addClass('ui-rotatable-autohide')\n          .mouseenter(function() {\n            $(this).removeClass('ui-rotatable-autohide');\n          })\n          .mouseleave(function() {\n            if(!_this.rotating) {\n              $(this).addClass('ui-rotatable-autohide');\n            }\n          });\n      }\n\n      this.bindRotation();\n    };\n\n    // Bind Rotation to Handler\n    this.bindRotation = function () {\n\n      // IE Fix\n      if ($.browser.msie) {\n        _rotator.mousedown(function (e) {\n          e.stopPropagation();\n        });\n\n        _rotator.mouseup(function (e) {\n          e.stopPropagation();\n        });\n      }\n\n      _rotator.draggable({\n        handle: _rotator,\n        helper: 'clone',\n        revert: false,\n        start: function (e) {\n          e.stopPropagation();\n          e.stopImmediatePropagation();\n\n          // Element Width & Height()\n          dims = {\n            'w': _this.width(),\n            'h': _this.height()\n          };\n\n          // Center Coords\n          center_coords = {\n            'x': _this.offset().left + _this.width() * 0.5,\n            'y': _this.offset().top + _this.height() * 0.5\n          };\n        },\n        drag: function (e) {\n          var mouse_coords, angle;\n\n          e.stopPropagation();\n          e.stopImmediatePropagation();\n\n          _this.rotating = true;\n\n          // Mouse Coords\n          mouse_coords = {\n            'x': e.pageX,\n            'y': e.pageY\n          };\n\n          angle = _this.radToDeg(_this.getAngle(mouse_coords, center_coords)) - 90;\n          if ($.browser.msie) { angle = -angle; }\n\n          return _this.rotate(angle);\n        },\n        stop: function () {\n          _this.rotating = false;\n        }\n      });\n    };\n\n    // Get Angle\n    this.getAngle = function (ms, ctr) {\n      var x = ms.x - ctr.x,\n        y = -ms.y + ctr.y,\n        hyp = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2)),\n        angle = Math.acos(x / hyp);\n\n      if (y < 0) {\n        angle = 2 * Math.PI - angle;\n      }\n\n      return angle;\n    };\n\n    // Convert from Degrees to Radians\n    this.degToRad = function (d) {\n      return (d * (Math.PI / 180));\n    };\n\n    // Convert from Radians to Degrees\n    this.radToDeg = function (r) {\n      return (r * (180 / Math.PI));\n    };\n\n    // Rotate Element to the Given Degree\n    this.rotate = function (degree) {\n      var cos = Math.cos(_this.degToRad(-degree)),\n        sin = Math.sin(_this.degToRad(-degree)),\n        mtx = [cos, sin, (-sin), cos];\n\n      this.updateRotationMatrix(mtx);\n    };\n\n    // Get CSS Transform Matrix (transform: matrix)\n    this.getRotationMatrix = function () {\n      var _matrix = _this.css('transform') || 'matrix(1, 0, 0, 1, 0, 0)',\n        _m = _matrix.split(','),\n        m = [],\n        i;\n\n      for (i = 0; i < 4; i++) {\n        m[i] = parseFloat(_m[i].replace('matrix(', ''));\n      }\n      return m;\n    };\n\n    // Update CSS Transform Matrix (transform: matrix)\n    this.updateRotationMatrix = function (m) {\n      var matrix = 'matrix(' + m[0] + ', ' + m[1] + ', ' + m[2] + ', ' + m[3] + ', 0, 0)',\n        ie_matrix = \"progid:DXImageTransform.Microsoft.Matrix(M11='\" + m[0] + \"', M12='\" + m[1] + \"', M21='\" + m[2] + \"', M22='\" + m[3] + \"', sizingMethod='auto expand')\";\n\n      _this.css({\n        '-moz-transform': matrix,\n        '-o-transform': matrix,\n        '-webkit-transform': matrix,\n        '-ms-transform': matrix,\n        'transform': matrix,\n        'filter': ie_matrix,\n        '-ms-filter': '\"' + ie_matrix + '\"'\n      });\n\n      // IE Fix\n      if ($.browser.msie) {\n        var coef = dims.w / dims.h,\n          _height = _this.parent().parent().height(),\n          _width = coef * _height,\n          _top = (dims.h - _height) / 2,\n          _left = (dims.w - _width) / 2;\n\n        _this.parent().parent().css({\n          'width': _width\n        });\n\n        _this.parent().css({\n          'left': _left,\n          'top': _top\n        });\n      }\n    };\n\n    return this.initialize();\n  };\n})(jQuery);"]],"start1":0,"start2":0,"length1":0,"length2":4983}]],"length":4983,"saved":false}
{"contributors":[],"silentsave":false,"ts":1367811884626,"patch":[[{"diffs":[[0,"\n *\n"],[-1," * Extended by Trevor Wistaff\n *\n"],[0," * h"]],"start1":152,"start2":152,"length1":41,"length2":8},{"diffs":[[0,"tion"],[-1," "],[0,"($) {\n  "],[-1,"'use strict';\n\n"],[0,"  $."]],"start1":189,"start2":189,"length1":32,"length2":16},{"diffs":[[0,"function"],[-1," "],[0,"(options"]],"start1":220,"start2":220,"length1":17,"length2":16},{"diffs":[[0,"ions) {\n"],[-1,"\n    "],[1,"\t\n\t\t"],[0,"// Defau"]],"start1":232,"start2":232,"length1":21,"length2":20},{"diffs":[[0," Values\n"],[-1,"    "],[1,"\t\t"],[0,"var defa"]],"start1":254,"start2":254,"length1":20,"length2":18},{"diffs":[[0,"ts = {\n "],[-1,"     "],[1,"\t\t\t"],[0,"rotatorC"]],"start1":274,"start2":274,"length1":21,"length2":19},{"diffs":[[0,"e',\n"],[1," \t\t\tmtx:   "],[0,"      "],[-1,"mtx:"],[0," [1,"]],"start1":318,"start2":318,"length1":18,"length2":25},{"diffs":[[0,", 1]"],[-1,","],[0,"\n  "],[-1,"    autoHide: true\n    }, opts"],[1,"\t\t},  opts       "],[0," = $"]],"start1":348,"start2":348,"length1":42,"length2":28},{"diffs":[[0,"options),\n  "],[1,"\t\t"],[0,"    _this = "]],"start1":394,"start2":394,"length1":24,"length2":26},{"diffs":[[0,"  _this "],[1,"      "],[0,"= this,\n"]],"start1":410,"start2":410,"length1":16,"length2":22},{"diffs":[[0,"  = this,\n  "],[1,"\t\t"],[0,"    _rotator"]],"start1":422,"start2":422,"length1":24,"length2":26},{"diffs":[[0,"ator"],[-1,", center_coords, dims;\n\n"],[1,";      \n  \t\t"],[0,"  "],[1,"\n"],[0,"  "],[1,"\t\t"],[0,"// I"]],"start1":444,"start2":444,"length1":36,"length2":27},{"diffs":[[0," \n  "],[-1,"  "],[1,"\t\t"],[0,"this.in"],[-1,"i"],[0,"tial"]],"start1":484,"start2":484,"length1":18,"length2":17},{"diffs":[[0,"alize = function"],[-1," "],[0,"() {\n      this."]],"start1":499,"start2":499,"length1":33,"length2":32},{"diffs":[[0,"n() {\n      "],[1,"  \t"],[0,"this.createH"]],"start1":514,"start2":514,"length1":24,"length2":27},{"diffs":[[0,"();\n"],[-1,"\n"],[0,"      "],[-1,"dims = {"],[1,"  \t"],[0,"\n   "]],"start1":547,"start2":547,"length1":23,"length2":17},{"diffs":[[0,"      \t\n        "],[1,"\tdims = {\n\t\t\t\t"],[0,"'w': _this.width"]],"start1":553,"start2":553,"length1":32,"length2":46},{"diffs":[[0,"idth(),\n"],[-1,"        "],[1,"\t\t\t\t"],[0,"'h': _th"]],"start1":595,"start2":595,"length1":24,"length2":20},{"diffs":[[0,"eight()\n"],[-1,"      };\n\n"],[1,"\t\t\t};\n  "],[0,"      "],[1,"\t"],[0,"this.upd"]],"start1":619,"start2":619,"length1":32,"length2":31},{"diffs":[[0,"s.mtx);\n    "],[-1,"};\n\n"],[1,"    };\n        \n  "],[0,"    "],[1,"  "],[0,"// Create Ro"]],"start1":671,"start2":671,"length1":32,"length2":48},{"diffs":[[0,"Handler\n    "],[1,"    "],[0,"this.createH"]],"start1":726,"start2":726,"length1":24,"length2":28},{"diffs":[[0,"ndler = function"],[-1," "],[0,"() {\n      _rota"]],"start1":755,"start2":755,"length1":33,"length2":32},{"diffs":[[0,"n() {\n      "],[1,"  \t"],[0,"_rotator = $"]],"start1":770,"start2":770,"length1":24,"length2":27},{"diffs":[[0,"class=\"'"],[-1," "],[0,"+ opts.r"]],"start1":804,"start2":804,"length1":17,"length2":16},{"diffs":[[0,"torClass"],[-1," "],[0,"+ '\"></d"]],"start1":823,"start2":823,"length1":17,"length2":16},{"diffs":[[0,"</div>');\n  "],[-1,"    "],[1,"\t\t\t"],[0,"_this.append"]],"start1":836,"start2":836,"length1":28,"length2":27},{"diffs":[[0,";\n  "],[-1,"    _this.rotating = false;\n\n      if(opts.autoHide) {\n        $(_this).addClass('ui-rotatable-autohide')\n          .mouseenter(function() {\n            $(this).removeClass('ui-rotatable-autohide');\n          })\n          .mouseleave(function() {\n            if(!_this.rotating) {\n              $(this).addClass('ui-rotatable-autohide')"],[1,"\t\t\t\n  \t\t\tthis.bindRotation();\n        }"],[0,";\n  "]],"start1":873,"start2":873,"length1":344,"length2":47},{"diffs":[[0,"    "],[-1,"}\n"],[0,"    "],[1,"\n"],[0,"    "],[-1,"  });\n      }\n\n      this.bindRotation();\n    };\n\n"],[0,"    "]],"start1":926,"start2":926,"length1":68,"length2":17},{"diffs":[[0," to Handler\n"],[1,"    "],[0,"    this.bin"]],"start1":959,"start2":959,"length1":24,"length2":28},{"diffs":[[0,"tion"],[-1," "],[0,"() {\n"],[1,"        "],[0,"\n      "],[1,"  \t"],[0,"// I"]],"start1":1003,"start2":1003,"length1":21,"length2":31},{"diffs":[[0,"// IE Fix\n      "],[1,"  \t"],[0,"if"],[-1," "],[0,"($.browser.msie)"]],"start1":1030,"start2":1030,"length1":35,"length2":37},{"diffs":[[0,"msie) {\n"],[1,"\t"],[0,"        "],[1,"\t"],[0,"_rotator"]],"start1":1062,"start2":1062,"length1":24,"length2":26},{"diffs":[[0,"function"],[-1," "],[0,"(e) {\n"],[1,"\t"],[0,"        "],[-1,"  "],[1,"\t\t"],[0,"e.stopPr"]],"start1":1099,"start2":1099,"length1":33,"length2":33},{"diffs":[[0,"tion();\n"],[1,"\t"],[0,"        "],[1,"\t"],[0,"});\n"],[-1,"\n"],[1,"\t        \n\t"],[0,"        "],[1,"\t"],[0,"_rotator"]],"start1":1137,"start2":1137,"length1":37,"length2":50},{"diffs":[[0,"function"],[-1," "],[0,"(e) {\n"],[1,"\t"],[0,"        "],[-1,"  "],[1,"\t\t"],[0,"e.stopPr"]],"start1":1196,"start2":1196,"length1":33,"length2":33},{"diffs":[[0,"();\n"],[1,"\t"],[0,"        "],[1,"\t"],[0,"});\n"],[1,"\t"],[0,"      "],[-1,"}\n\n"],[1,"  }\n\t\t\t\n  "],[0,"      "],[1,"\t"],[0,"_rot"]],"start1":1238,"start2":1238,"length1":35,"length2":46},{"diffs":[[0,"gable({\n"],[-1,"        "],[1,"\t\t\t\t"],[0,"handle: "]],"start1":1293,"start2":1293,"length1":24,"length2":20},{"diffs":[[0,"otator,\n"],[-1,"        "],[1,"\t\t\t\t"],[0,"helper: "]],"start1":1315,"start2":1315,"length1":24,"length2":20},{"diffs":[[0,"clone',\n"],[-1,"        "],[1,"\t\t\t\t"],[0,"revert: "]],"start1":1336,"start2":1336,"length1":24,"length2":20},{"diffs":[[0,"se,\n"],[-1,"        "],[1,"\t\t\t\t"],[0,"start:"],[1," "],[0," fun"]],"start1":1359,"start2":1359,"length1":22,"length2":19},{"diffs":[[0,"start:  function"],[-1," "],[0,"(e) {\n          "]],"start1":1367,"start2":1367,"length1":33,"length2":32},{"diffs":[[0,"on(e) {\n        "],[-1,"  "],[1,"\t\t\t"],[0,"e.stopPropagatio"]],"start1":1381,"start2":1381,"length1":34,"length2":35},{"diffs":[[0,"tion();\n        "],[-1,"  "],[1,"\t\t\t"],[0,"e.stopImmediateP"]],"start1":1413,"start2":1413,"length1":34,"length2":35},{"diffs":[[0,"tion();\n"],[-1,"\n  "],[0,"        "],[1,"\t\t\t\n        \t\t\t// TL Corner Coords\n        \t\t\ttl_coords = {\n        \t\t\t\t'x': parseInt(_this.parent().css('left')),\n\t\t\t\t\t\t'y': parseInt(_this.parent().css('top'))\n        \t\t\t};\n        \t\t\t\n        \t\t\t"],[0,"// Eleme"]],"start1":1454,"start2":1454,"length1":27,"length2":223},{"diffs":[[0,"        "],[-1,"  "],[1,"\t\t\t"],[0,"dims = {"]],"start1":1697,"start2":1697,"length1":18,"length2":19},{"diffs":[[0,"        "],[-1,"    "],[1,"\t\t\t\t"],[0,"'w': _th"]],"start1":1717,"start2":1717,"length1":20,"length2":20},{"diffs":[[0,"        "],[-1,"    "],[1,"\t\t\t\t"],[0,"'h': _th"]],"start1":1749,"start2":1749,"length1":20,"length2":20},{"diffs":[[0,"        "],[-1,"  };\n\n          "],[1,"\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t"],[0,"// Cente"]],"start1":1781,"start2":1781,"length1":32,"length2":33},{"diffs":[[0," Coords\n"],[-1,"          "],[1,"\t\t\t\t\t"],[0,"center_c"]],"start1":1815,"start2":1815,"length1":26,"length2":21},{"diffs":[[0,"_coords = {\n"],[-1,"            "],[1,"\t\t\t\t\t\t"],[0,"'x': _this.o"]],"start1":1834,"start2":1834,"length1":36,"length2":30},{"diffs":[[0,"th()"],[1," "],[0," * 0.5,\n"],[-1,"            "],[1,"\t\t\t\t\t\t"],[0,"'y':"]],"start1":1888,"start2":1888,"length1":28,"length2":23},{"diffs":[[0,"t().top "],[1," "],[0,"+ _this."]],"start1":1923,"start2":1923,"length1":16,"length2":17},{"diffs":[[0,"0.5\n"],[-1,"          };\n        },\n        "],[1,"\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\t"],[0,"drag:"],[1," "],[0," fun"]],"start1":1951,"start2":1951,"length1":45,"length2":33},{"diffs":[[0,"function"],[-1," "],[0,"(e) {\n  "]],"start1":1981,"start2":1981,"length1":17,"length2":16},{"diffs":[[0,"    "],[-1,"  var mouse_coords, angle;\n\n          "],[1,"\t\t\t"],[0,"e.st"]],"start1":1999,"start2":1999,"length1":46,"length2":11},{"diffs":[[0,"        "],[-1,"  "],[1,"\t\t\t"],[0,"e.stopIm"]],"start1":2027,"start2":2027,"length1":18,"length2":19},{"diffs":[[0,"();\n"],[-1,"\n"],[0,"        "],[-1,"  _this.rotating = true;\n\n          "],[1,"\t\t\t\n\t\t\t\t\t"],[0,"// M"]],"start1":2064,"start2":2064,"length1":53,"length2":25},{"diffs":[[0," Coords\n"],[-1,"          "],[1,"\t\t\t\t\t"],[0,"mouse_co"]],"start1":2093,"start2":2093,"length1":26,"length2":21},{"diffs":[[0,"rds = {\n"],[-1,"            "],[1,"\t\t\t\t\t\t"],[0,"'x': e.p"]],"start1":2115,"start2":2115,"length1":28,"length2":22},{"diffs":[[0,".pageX,\n"],[-1,"            "],[1,"\t\t\t\t\t\t"],[0,"'y': e.p"]],"start1":2135,"start2":2135,"length1":28,"length2":22},{"diffs":[[0,"geY\n"],[-1,"          };\n\n          "],[1,"\t\t\t\t\t};\t\n\t\t\t\t\t\n\t\t\t\t\t"],[0,"angl"]],"start1":2158,"start2":2158,"length1":32,"length2":28},{"diffs":[[0,"90;\n"],[-1,"          "],[1,"\t\t\t\t\t"],[0,"if"],[-1," "],[0,"($.b"]],"start1":2252,"start2":2252,"length1":21,"length2":15},{"diffs":[[0,"sie)"],[-1," { "],[1,"\n\t\t\t\t\t\t"],[0,"angl"]],"start1":2275,"start2":2275,"length1":11,"length2":15},{"diffs":[[0," = -"],[1," "],[0,"angle;"],[-1," }\n\n          "],[1,"\n\t\t\t\t\t\n\t\t\t\t\t"],[0,"retu"]],"start1":2291,"start2":2291,"length1":28,"length2":27},{"diffs":[[0,"e);\n"],[-1,"        },\n        stop: function () {\n          _this.rotating = false"],[1,"\t\t\t\t}\n        \t});\n        }"],[0,";\n  "]],"start1":2338,"start2":2338,"length1":79,"length2":36},{"diffs":[[0,"    "],[-1,"}"],[0,"\n    "],[-1,"  });\n    };\n\n"],[0,"    "]],"start1":2376,"start2":2376,"length1":28,"length2":13},{"diffs":[[0,"t Angle\n"],[1,"    "],[0,"    this"]],"start1":2394,"start2":2394,"length1":16,"length2":20},{"diffs":[[0,"function"],[-1," "],[0,"(ms, ctr"]],"start1":2426,"start2":2426,"length1":17,"length2":16},{"diffs":[[0,"    "],[1,"  \t"],[0,"var x "],[1,"    "],[0,"= ms"]],"start1":2448,"start2":2448,"length1":14,"length2":21},{"diffs":[[0,"    "],[-1,"y"],[1,"\t    y    "],[0," = -"],[1," "],[0,"ms.y"]],"start1":2485,"start2":2485,"length1":13,"length2":23},{"diffs":[[0,"    "],[1,"\t    "],[0,"hyp "],[1,"  "],[0,"= Ma"]],"start1":2522,"start2":2522,"length1":12,"length2":19},{"diffs":[[0,"y, 2)),\n        "],[1,"\t    "],[0,"angle = Math.aco"]],"start1":2575,"start2":2575,"length1":32,"length2":37},{"diffs":[[0,"/ hyp);\n"],[1,"        \t"],[0,"\n      "],[1,"  \t"],[0,"if (y < "]],"start1":2616,"start2":2616,"length1":23,"length2":35},{"diffs":[[0,"y < 0) {"],[1,"    "],[0,"\n       "]],"start1":2647,"start2":2647,"length1":16,"length2":20},{"diffs":[[0,"   \n        "],[1,"\t\t"],[0,"angle = 2 * "]],"start1":2656,"start2":2656,"length1":24,"length2":26},{"diffs":[[0,"    "],[-1,"}\n\n   "],[1,"  \t}\n        \t\n\t\t"],[0,"   "],[1," "],[0,"retu"]],"start1":2701,"start2":2701,"length1":17,"length2":29},{"diffs":[[0," angle;\n    "],[-1,"};\n\n"],[1,"    };\n        \n  "],[0,"    "],[1,"  "],[0,"// Convert f"]],"start1":2732,"start2":2732,"length1":32,"length2":48},{"diffs":[[0,"Radians\n"],[1,"    "],[0,"    this"]],"start1":2795,"start2":2795,"length1":16,"length2":20},{"diffs":[[0,"function"],[-1," "],[0,"(d) {\n  "]],"start1":2827,"start2":2827,"length1":17,"length2":16},{"diffs":[[0,"tion(d) {\n      "],[1,"  \t"],[0,"return (d * (Mat"]],"start1":2831,"start2":2831,"length1":32,"length2":35},{"diffs":[[0," 180));\n    "],[-1,"};\n\n"],[1,"    };\n        \n    "],[0,"    // Conve"]],"start1":2872,"start2":2872,"length1":28,"length2":44},{"diffs":[[0,"Degrees\n"],[1,"    "],[0,"    this"]],"start1":2935,"start2":2935,"length1":16,"length2":20},{"diffs":[[0,"function"],[-1," "],[0,"(r) {\n  "]],"start1":2967,"start2":2967,"length1":17,"length2":16},{"diffs":[[0,"(r) {\n      "],[1,"  \t"],[0,"return (r * "]],"start1":2975,"start2":2975,"length1":24,"length2":27},{"diffs":[[0,"h.PI));\n    "],[-1,"};\n\n"],[1,"    };\n        \n    "],[0,"    // Rotat"]],"start1":3012,"start2":3012,"length1":28,"length2":44},{"diffs":[[0," Degree\n"],[1,"    "],[0,"    this"]],"start1":3078,"start2":3078,"length1":16,"length2":20},{"diffs":[[0,"function"],[-1," "],[0,"(degree)"]],"start1":3108,"start2":3108,"length1":17,"length2":16},{"diffs":[[0,"ee) {\n      "],[1,"  \t"],[0,"var cos = Ma"]],"start1":3121,"start2":3121,"length1":24,"length2":27},{"diffs":[[0,"        "],[1,"\t    "],[0,"sin = Ma"]],"start1":3181,"start2":3181,"length1":16,"length2":21},{"diffs":[[0,"        "],[1,"\t    "],[0,"mtx = [c"]],"start1":3235,"start2":3235,"length1":16,"length2":21},{"diffs":[[0,", cos];\n"],[1,"        \t    "],[0,"\n      "],[1,"  \t"],[0,"this.upd"]],"start1":3271,"start2":3271,"length1":23,"length2":39},{"diffs":[[0,"x(mtx);\n    "],[-1,"};\n\n"],[1,"    };\n        \n    "],[0,"    // Get C"]],"start1":3326,"start2":3326,"length1":28,"length2":44},{"diffs":[[0,"nsform: matrix)\n"],[1,"    "],[0,"    this.getRota"]],"start1":3394,"start2":3394,"length1":32,"length2":36},{"diffs":[[0,"function"],[-1," "],[0,"() {\n   "]],"start1":3443,"start2":3443,"length1":17,"length2":16},{"diffs":[[0,"n() {\n      "],[1,"  \t"],[0,"var _matrix "]],"start1":3450,"start2":3450,"length1":24,"length2":27},{"diffs":[[0,"m') "],[-1,"||"],[1,"? _this.css('transform') :"],[0," 'ma"]],"start1":3498,"start2":3498,"length1":10,"length2":34},{"diffs":[[0," 0)'"],[-1,",\n"],[1,";\n\t\t\t"],[0,"    "],[1,"_m "],[0,"    "],[-1,"_m"],[0," = _"]],"start1":3551,"start2":3551,"length1":20,"length2":24},{"diffs":[[0,"    "],[-1,"m"],[1,"\t    m      "],[0," = []"],[-1,","],[1,";"],[0,"\n   "]],"start1":3598,"start2":3598,"length1":15,"length2":26},{"diffs":[[0,"    "],[-1,"i;\n\n"],[1,"\t    \n  "],[0,"      "],[1,"\t"],[0,"for "]],"start1":3625,"start2":3625,"length1":18,"length2":23},{"diffs":[[0,"        "],[1,"\t\t"],[0,"m[i] = p"]],"start1":3670,"start2":3670,"length1":16,"length2":18},{"diffs":[[0,";\n      "],[1,"  \t"],[0,"}\n      "],[1,"  \t        \t\n        \t"],[0,"return m"]],"start1":3727,"start2":3727,"length1":24,"length2":49},{"diffs":[[0,"turn m;\n    "],[-1,"};\n\n"],[1,"    };\n        \n    "],[0,"    // Updat"]],"start1":3770,"start2":3770,"length1":28,"length2":44},{"diffs":[[0,"matrix)\n    "],[1,"    "],[0,"this.updateR"]],"start1":3849,"start2":3849,"length1":24,"length2":28},{"diffs":[[0,"function"],[-1," "],[0,"(m) {\n  "]],"start1":3893,"start2":3893,"length1":17,"length2":16},{"diffs":[[0,"(m) {\n      "],[1,"  \t"],[0,"var matrix ="]],"start1":3901,"start2":3901,"length1":24,"length2":27},{"diffs":[[0,"ix('"],[-1," "],[0,"+ m[0] +"],[-1," "],[0,"', '"],[-1," "],[0,"+ m[1] +"],[-1," "],[0,"', '"],[-1," "],[0,"+ m[2] +"],[-1," "],[0,"', '"],[-1," "],[0,"+ m[3] +"],[-1," "],[0,"', 0"]],"start1":3934,"start2":3934,"length1":60,"length2":52},{"diffs":[[0,"        "],[1,"\t    "],[0,"ie_matri"]],"start1":3993,"start2":3993,"length1":16,"length2":21},{"diffs":[[0,"1='\""],[-1," + "],[1,"+"],[0,"m[0]"],[-1," + "],[1,"+"],[0,"\"', "]],"start1":4062,"start2":4062,"length1":18,"length2":14},{"diffs":[[0,"2='\""],[-1," + "],[1,"+"],[0,"m[1]"],[-1," + "],[1,"+"],[0,"\"', "]],"start1":4078,"start2":4078,"length1":18,"length2":14},{"diffs":[[0,"1='\""],[-1," + "],[1,"+"],[0,"m[2]"],[-1," + "],[1,"+"],[0,"\"', "]],"start1":4094,"start2":4094,"length1":18,"length2":14},{"diffs":[[0,"2='\""],[-1," + "],[1,"+"],[0,"m[3]"],[-1," + "],[1,"+"],[0,"\"', "]],"start1":4110,"start2":4110,"length1":18,"length2":14},{"diffs":[[0,"pand')\";"],[-1,"\n\n"],[1,"        \t\n        \t  \n "],[0,"      "],[1," \t"],[0,"_this.cs"]],"start1":4145,"start2":4145,"length1":24,"length2":47},{"diffs":[[0,"s.css({\n"],[-1,"        "],[1,"\t\t\t\t"],[0,"'-moz-tr"]],"start1":4188,"start2":4188,"length1":24,"length2":20},{"diffs":[[0,"'-moz-transform'"],[1,"   "],[0,": matrix,\n      "]],"start1":4200,"start2":4200,"length1":32,"length2":35},{"diffs":[[0,"matrix,\n"],[-1,"        "],[1,"\t\t\t\t"],[0,"'-o-tran"]],"start1":4221,"start2":4221,"length1":24,"length2":20},{"diffs":[[0,"\t\t'-o-transform'"],[1,"     "],[0,": matrix,\n      "]],"start1":4231,"start2":4231,"length1":32,"length2":37},{"diffs":[[0,"        "],[1,"\t\t"],[0,"'-webkit"]],"start1":4262,"start2":4262,"length1":16,"length2":18},{"diffs":[[0,"ix,\n        "],[1,"\t\t"],[0,"'-ms-transfo"]],"start1":4297,"start2":4297,"length1":24,"length2":26},{"diffs":[[0,"\t'-ms-transform'"],[1,"    "],[0,": matrix,\n      "]],"start1":4310,"start2":4310,"length1":32,"length2":36},{"diffs":[[0,"matrix,\n"],[-1,"        "],[1,"\t\t\t\t"],[0,"'transfo"]],"start1":4332,"start2":4332,"length1":24,"length2":20},{"diffs":[[0,"\n\t\t\t\t'transform'"],[1,"        "],[0,": matrix,\n      "]],"start1":4339,"start2":4339,"length1":32,"length2":40},{"diffs":[[0,"ix,\n"],[1,"\t\t\t\t'filter'   "],[0,"        "],[-1,"'filter'"],[0,": ie"]],"start1":4369,"start2":4369,"length1":24,"length2":31},{"diffs":[[0,"matrix,\n"],[-1,"        "],[1,"\t\t\t\t"],[0,"'-ms-fil"]],"start1":4401,"start2":4401,"length1":24,"length2":20},{"diffs":[[0,"-filter'"],[1,"       "],[0,": '\"' + "]],"start1":4417,"start2":4417,"length1":16,"length2":23},{"diffs":[[0,"x + '\"'\n"],[1,"\t\t\t});\n  "],[0,"      "],[-1,"});\n"],[1,"\t"],[0,"\n      "],[1,"  \t"],[0,"// IE Fi"]],"start1":4448,"start2":4448,"length1":33,"length2":42},{"diffs":[[0,"x\n      "],[1,"  \t"],[0,"if"],[-1," "],[0,"($.brows"]],"start1":4490,"start2":4490,"length1":19,"length2":21},{"diffs":[[0,"    "],[1,"\t\t"],[0,"var"],[-1," "],[1,"\t"],[0,"coef "],[1,"   "],[0,"= di"]],"start1":4526,"start2":4526,"length1":17,"length2":22},{"diffs":[[0,"dims.h,\n"],[1,"\t"],[0,"        "],[1,"\t  "],[0,"  _heigh"]],"start1":4555,"start2":4555,"length1":24,"length2":28},{"diffs":[[0,"height()"],[-1,","],[0,"\n"],[1,"\t  "],[0,"      "],[1,"\t"],[0,"    _wid"]],"start1":4611,"start2":4611,"length1":24,"length2":27},{"diffs":[[0," _width "],[1," "],[0,"= coef *"]],"start1":4633,"start2":4633,"length1":16,"length2":17},{"diffs":[[0,"ht,\n"],[1,"\t"],[0,"        "],[1,"\t "],[0,"  "],[1," "],[0,"_top "],[1,"   "],[0,"= (d"]],"start1":4656,"start2":4656,"length1":23,"length2":30},{"diffs":[[0," 2,\n"],[1,"\t"],[0,"        "],[1,"\t "],[0,"  "],[1," "],[0,"_left "],[1,"  "],[0,"= (d"]],"start1":4704,"start2":4704,"length1":24,"length2":30},{"diffs":[[0,"h) / 2;\n"],[-1,"\n"],[1,"\t        \t\n\t"],[0,"        "],[1,"\t"],[0,"_this.pa"]],"start1":4747,"start2":4747,"length1":25,"length2":37},{"diffs":[[0,"s({\n"],[1,"\t"],[0,"        "],[-1,"  "],[1,"\t\t"],[0,"'width'"],[1,"      "],[0,": _w"]],"start1":4802,"start2":4802,"length1":25,"length2":32},{"diffs":[[0,"dth\n"],[1,"\t"],[0,"        "],[1,"\t"],[0,"});\n"],[-1,"\n"],[1,"\t        \t\n\t"],[0,"        "],[1,"\t"],[0,"_thi"]],"start1":4835,"start2":4835,"length1":29,"length2":43},{"diffs":[[0,").css({\n"],[1,"\t"],[0,"        "],[-1,"  "],[1,"\t\t"],[0,"'left': "]],"start1":4887,"start2":4887,"length1":26,"length2":27},{"diffs":[[0,"ft,\n"],[1,"\t"],[0,"        "],[-1,"  "],[1,"\t\t"],[0,"'top'"],[1," "],[0,": _top\n"],[1,"\t"],[0,"        "],[1,"\t"],[0,"});\n"]],"start1":4917,"start2":4917,"length1":38,"length2":42},{"diffs":[[0,"    "],[1,"  \t"],[0,"}\n    "],[-1,"};\n\n"],[1,"    };\n        \n    "],[0,"    "]],"start1":4961,"start2":4961,"length1":18,"length2":37},{"diffs":[[0," this.in"],[-1,"i"],[0,"tialize("]],"start1":5004,"start2":5004,"length1":17,"length2":16},{"diffs":[[0,"e();"],[-1,"\n"],[0,"  "],[1,"\t\t\n\t"],[0,"}"],[-1,";"],[0,"\n})("]],"start1":5018,"start2":5018,"length1":13,"length2":15}]],"length":5041,"saved":false}
{"ts":1367812494816,"patch":[[{"diffs":[[-1,"/*!\n * jQuery Element Rotation Plugin\n *\n * Requires jQueryUI \n *\n * Copyright (c) 2010 Pavel Markovnin\n * Dual licensed under the MIT and GPL licenses.\n *\n * http://vremenno.net\n */\n\n(function($) {\n    $.fn.rotatable = function(options) {\n\t\n\t\t// Default Values\n\t\tvar defaults = {\n \t\t\trotatorClass: 'ui-rotatable-handle',\n \t\t\tmtx:          [1, 0, 0, 1]\n  \t\t},  opts        = $.extend(defaults, options),\n  \t\t    _this       = this,\n  \t\t    _rotator;      \n  \t\t  \n  \t\t// Initialization \n  \t\tthis.intialize = function() {\n        \tthis.createHandler();\n        \t\n        \tdims = {\n\t\t\t\t'w': _this.width(),\n\t\t\t\t'h': _this.height()\n\t\t\t};\n        \tthis.updateRotationMatrix(opts.mtx);\n        };\n        \n        // Create Rotation Handler\n        this.createHandler = function() {\n        \t_rotator = $('<div class=\"'+ opts.rotatorClass+ '\"></div>');\n  \t\t\t_this.append(_rotator);\n  \t\t\t\n  \t\t\tthis.bindRotation();\n        };\n                \n        // Bind Rotation to Handler\n        this.bindRotation = function() {\n        \n        \t// IE Fix\n        \tif($.browser.msie) {\n\t        \t_rotator.mousedown(function(e) {\n\t        \t\te.stopPropagation();\n\t        \t});\n\t        \n\t        \t_rotator.mouseup(function(e) {\n\t        \t\te.stopPropagation();\n\t        \t});\n\t        }\n\t\t\t\n        \t_rotator.draggable({\n\t\t\t\thandle: _rotator,\n\t\t\t\thelper: 'clone',\n\t\t\t\trevert: false,\n\t\t\t\tstart:  function(e) {\n        \t\t\te.stopPropagation();\n        \t\t\te.stopImmediatePropagation();\n        \t\t\t\n        \t\t\t// TL Corner Coords\n        \t\t\ttl_coords = {\n        \t\t\t\t'x': parseInt(_this.parent().css('left')),\n\t\t\t\t\t\t'y': parseInt(_this.parent().css('top'))\n        \t\t\t};\n        \t\t\t\n        \t\t\t// Element Width & Height()\n        \t\t\tdims = {\n        \t\t\t\t'w': _this.width(),\n        \t\t\t\t'h': _this.height()\n        \t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t// Center Coords\n\t\t\t\t\tcenter_coords = {\n\t\t\t\t\t\t'x': _this.offset().left + _this.width()  * 0.5,\n\t\t\t\t\t\t'y': _this.offset().top  + _this.height() * 0.5\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tdrag:  function(e) {\n        \t\t\te.stopPropagation();\n        \t\t\te.stopImmediatePropagation();\n        \t\t\t\n\t\t\t\t\t// Mouse Coords\n\t\t\t\t\tmouse_coords = {\n\t\t\t\t\t\t'x': e.pageX,\n\t\t\t\t\t\t'y': e.pageY\n\t\t\t\t\t};\t\n\t\t\t\t\t\n\t\t\t\t\tangle = _this.radToDeg(_this.getAngle(mouse_coords, center_coords)) - 90;\n\t\t\t\t\tif($.browser.msie)\n\t\t\t\t\t\tangle = - angle;\n\t\t\t\t\t\n\t\t\t\t\treturn _this.rotate(angle);\n\t\t\t\t}\n        \t});\n        };\n        \n        // Get Angle\n        this.getAngle = function(ms, ctr) {\n        \tvar x     = ms.x - ctr.x,\n        \t    y     = - ms.y + ctr.y,\n        \t    hyp   = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2)),\n        \t    angle = Math.acos(x / hyp);\n        \t\n        \tif (y < 0) {    \n        \t\tangle = 2 * Math.PI - angle;\n        \t}\n        \t\n\t\t    return angle;\n        };\n        \n        // Convert from Degrees to Radians\n        this.degToRad = function(d) {\n        \treturn (d * (Math.PI / 180));\n        };\n        \n        // Convert from Radians to Degrees\n        this.radToDeg = function(r) {\n        \treturn (r * (180 / Math.PI));\n        };\n        \n        // Rotate Element to the Given Degree\n        this.rotate = function(degree) {\n        \tvar cos = Math.cos(_this.degToRad(-degree)),\n        \t    sin = Math.sin(_this.degToRad(-degree)),\n        \t    mtx = [cos, sin, (-sin), cos];\n        \t    \n        \tthis.updateRotationMatrix(mtx);\n        };\n        \n        // Get CSS Transform Matrix (transform: matrix)\n        this.getRotationMatrix = function() {\n        \tvar _matrix = _this.css('transform') ? _this.css('transform') : 'matrix(1, 0, 0, 1, 0, 0)';\n\t\t\t    _m      = _matrix.split(','),\n        \t    m       = [];\n        \t    \n        \tfor (i = 0; i < 4; i++) {\n        \t\tm[i] = parseFloat(_m[i].replace('matrix(', ''));\n        \t}\n        \t        \t\n        \treturn m;\n        };\n        \n        // Update CSS Transform Matrix (transform: matrix)\n        this.updateRotationMatrix = function(m) {\n        \tvar matrix = 'matrix('+ m[0] +', '+ m[1] +', '+ m[2] +', '+ m[3] +', 0, 0)',\n        \t    ie_matrix = \"progid:DXImageTransform.Microsoft.Matrix(M11='\"+m[0]+\"', M12='\"+m[1]+\"', M21='\"+m[2]+\"', M22='\"+m[3]+\"', sizingMethod='auto expand')\";        \t\n        \t  \n        \t_this.css({\n\t\t\t\t'-moz-transform'   : matrix,\n\t\t\t\t'-o-transform'     : matrix,\n        \t\t'-webkit-transform': matrix,\n        \t\t'-ms-transform'    : matrix,\n\t\t\t\t'transform'        : matrix,\n\t\t\t\t'filter'           : ie_matrix,\n\t\t\t\t'-ms-filter'       : '\"' + ie_matrix + '\"'\n\t\t\t});\n        \t\n        \t// IE Fix\n        \tif($.browser.msie) {\n        \t\tvar\tcoef    = dims.w / dims.h,\n\t        \t    _height = _this.parent().parent().height()\n\t        \t    _width  = coef * _height,\n\t        \t    _top    = (dims.h - _height) / 2,\n\t        \t    _left   = (dims.w - _width) / 2;\n\t        \t\n\t        \t_this.parent().parent().css({\n\t        \t\t'width'      : _width\n\t        \t});\n\t        \t\n\t        \t_this.parent().css({\n\t        \t\t'left': _left,\n\t        \t\t'top' : _top\n\t        \t});\n        \t}\n        };\n        \n        return this.intialize();  \t\t\n\t}\n})(jQuery);"],[1,"(function($)\n{\n    $.widget(\"ui.rotatable\", $.ui.mouse, {\n        version: \"1.10.0\",\n        widgetEventPrefix: \"rotate\",\n        options: {\n            addClasses: true,\n            appendTo: \"parent\",\n            cursor: \"auto\",\n            handle: false,\n            helper: \"original\",\n            opacity: \"false\",\n           \n            //callbacks\n            rotate: null,\n            start: null,\n            stop: null\n        },\n        _create: function()\n        {\n            if (this.options.addClasses)\n            {\n                this.element.addClass(\"ui-rotatable\");\n            }\n            if (this.options.disabled)\n            {\n                this.element.addClass(\"ui-rotatable-disabled\");\n            }\n\n            this.handles = this.options.handles || (!$('.ui-rotatable-handle', this.element).length ? \"e,s,se\" : { n: '.ui-rotatable-n', e: '.ui-rotatable-e', s: '.ui-rotatable-s', w: '.ui-rotatable-w', se: '.ui-rotatable-se', sw: '.ui-rotatable-sw', ne: '.ui-rotatable-ne', nw: '.ui-rotatable-nw' });\n            if (this.handles.constructor == String)\n            {\n\n                if (this.handles == 'all')\n                {\n                    this.handles = 'n,e,s,w,se,sw,ne,nw';\n                }\n                var n = this.handles.split(\",\"); this.handles = {};\n\n                for (var i = 0; i < n.length; i++)\n                {\n\n                    var handle = $.trim(n[i]), hname = 'ui-rotatable-' + handle;\n                    var axis = $('<div class=\"ui-rotatable-handle ui-resizable-handle ' + hname + '\"></div>');\n\n                    // Apply zIndex to all handles - see #7960\n                    axis.css({ zIndex: this.options.zIndex });\n\n                    //Insert into internal handles object and append to element\n                    this.handles[handle] = axis;\n                    this.element.append(axis);\n                }\n            }\n\n            this._mouseInit();\n        },\n       \n        _destroy: function()\n        {\n            this.element.removeClass(\"ui-rotatable ui-rotatable-rotating ui-rotatable-disabled\");\n            this._mouseDestroy();\n        },\n       \n        _mouseCapture: function(event)\n        {\n            var o = this.options;\n\n            var handle = false;\n            if (o.handles)\n            {\n                for (var i in this.handles)\n                {\n                    if ($(this.handles[i])[0] == event.target)\n                    {\n                        handle = true;\n                    }\n                }\n            }\n            else\n            {\n                handle = true;\n            }\n\n            return !this.options.disabled && handle;\n        },\n       \n        _mouseStart: function(event)\n        {\n            var o = this.options;\n\n            this.helper = this._createHelper(event);\n\n            this.helper.addClass(\"ui-rotatable-rotating\");\n\n            this._cacheHelperAngle();\n\n            this.originalAngle = this.angle = this._getRotationAngle();\n\n            if (this._trigger(\"start\", event) === false)\n            {\n                this._clear();\n                return false;\n            }\n\n            this._cacheHelperProportions();\n\n            this._cacheCenterPoint();\n\n            this.mouseStartPosition = { 'x': event.pageX, 'y': event.pageY };\n\n            this._mouseDrag(event, true);\n\n            return true;\n        },\n        \n        _mouseDrag: function(event, noPropagation)\n        {\n            this.angle = parseInt(this._generateAngle(event) * (180 / Math.PI) - 90);\n\n            this.angle = this.angle < 0 ? 360 + this.angle : this.angle;\n\n            if (!noPropagation)\n            {\n                var ui = this._uiHash();\n                if (this._trigger(\"rotate\", event, ui) === false)\n                {\n                    this._mouseUp({});\n                    return false;\n                }\n\n                this.angle = ui.angle;\n            }\n\n            var me = this;\n\n            var setIEAngle = function (angle)\n            {\n                //fix IE8 bug where handles stay unrotated. This helps, but only partually\n                //any part of the handles that are outside of the rotatable element\n                //will be cut off. Might need to wrap element into container and rotate container\n                if (me.helper.css(\"z-index\") === \"auto\")\n                {\n                    me.helper.css(\"z-index\", 1);\n                }\n                this.helper = me.helper[0];\n                var rad = Math.PI / 180;\n                this._angle = angle;\n                    \n                var _rad = angle * rad;\n                costheta = Math.cos(_rad);\n                sintheta = Math.sin(_rad);\n                this.helper.style.filter = \"progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingmethod='auto expand')\";\n                var fil = this.helper.filters.item(\"DXImageTransform.Microsoft.Matrix\");\n                fil.M11 = costheta;\n                fil.M12 = -sintheta;\n                fil.M21 = sintheta;\n                fil.M22 = costheta;\n                this.helper.style.marginLeft = -(this.helper.offsetWidth - this.helper.clientWidth) / 2 + \"px\";\n                this.helper.style.marginTop = -(this.helper.offsetHeight - this.helper.clientHeight) / 2 + \"px\";\n            };\n\n            var prefixes = 'transform WebkitTransform MozTransform OTransform msTransform'.split(' ');\n            var supportTranform = false;\n            for (var i = 0; i < prefixes.length; i++)\n            {\n                if (document.createElement('div').style[prefixes[i]] !== undefined)\n                {\n                    supportTranform = true;\n                    break;\n                }\n            }\n\n\n            if (!supportTranform)\n            {\n                setIEAngle(this.angle);\n            }\n\n            //set angle\n            this.helper.css({\n                '-webkit-transform': 'rotate(' + this.angle + 'deg)',\n                '-moz-transform': 'rotate(' + this.angle + 'deg)',\n                '-ms-transform': 'rotate(' + this.angle + 'deg)',\n                '-o-transform': 'rotate(' + this.angle + 'deg)',\n                'transform': 'rotate(' + this.angle + 'deg)'\n            });\n\n            return false;\n        },\n        \n        _mouseStop: function(event)\n        {\n            if (this._trigger(\"stop\", event) !== false)\n            {\n                this._clear();\n            }\n            return false;\n        },\n        \n        _mouseUp: function(event)\n        {\n            return $.ui.mouse.prototype._mouseUp.call(this, event);\n        },\n        \n        _getHandle: function(event)\n        {\n            var handle = !this.options.handles || !$(this.options.handles, this.element).length ? true : false;\n            $(this.options.handles, this.element).find(\"*\").addBack().each(function() {\n                if (this === event.target)\n                {\n                    handle = true;\n                }\n            });\n\n            return handle;\n        },\n        \n        _createHelper: function(event)\n        {\n            var o = this.options,\n                helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event])) : (o.helper === \"clone\" ? this.element.clone().removeAttr(\"id\") : this.element);\n\n            if(!helper.parents(\"body\").length) {\n                helper.appendTo((o.appendTo === \"parent\" ? this.element[0].parentNode : o.appendTo));\n            }\n\n            if(helper[0] !== this.element[0] && !(/(fixed|absolute)/).test(helper.css(\"position\"))) {\n                helper.css(\"position\", \"absolute\");\n            }\n\n            return helper;\n        },\n        \n        _cacheHelperProportions: function() {\n            this.helperProportions = {\n                width: this.helper.outerWidth(),\n                height: this.helper.outerHeight()\n            };\n        },\n\n        _cacheCenterPoint: function ()\n        {\n            var helperOffset = this.helper.offset();\n            this.centerPoint = {\n                x: helperOffset.left + this.helperProportions.width / 2,\n                y: helperOffset.top + this.helperProportions.height / 2\n            };\n        },\n\n        _cacheHelperAngle: function() {\n            this.helperAngle = this._getRotationAngle();\n        },\n\n        _generateAngle: function(event) {\n            //this is where we figure out new angle\n            var mouse_coords = { 'x': event.pageX, 'y': event.pageY };\n            return angle = this._positionToAngle(mouse_coords);\n        },\n        \n        _clear: function() {\n            this.helper.removeClass(\"ui-rotatable-rotating\");\n            if(this.helper[0] !== this.element[0] && !this.cancelHelperRemoval) {\n                this.helper.remove();\n            }\n            this.helper = null;\n            this.cancelHelperRemoval = false;\n        },\n\n        // From now on bulk stuff - mainly helpers\n\n        _trigger: function(type, event, ui) {\n            ui = ui || this._uiHash();\n            $.ui.plugin.call(this, type, [event, ui]);\n            //The absolute position has to be recalculated after plugins\n            if(type === \"rotate\") {\n                //this.positionAbs = this._convertPositionTo(\"absolute\");\n            }\n            return $.Widget.prototype._trigger.call(this, type, event, ui);\n        },\n\n        _positionToAngle: function(position) {\n            var x = position.x - this.centerPoint.x,\n                y = position.y - this.centerPoint.y,\n                hyp = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2)),\n                angle = Math.acos(x / hyp);\n            if (y < 0)\n            {\n                angle = 2 * Math.PI - angle;\n            }\n            return angle;\n        },\n\n        plugins: {},\n\n        _uiHash: function() {\n            return {\n                helper: this.helper,\n                angle: this.angle,\n                originalAngle: this.originalAngle\n            };\n        },\n\n        _getRotationAngle: function()\n        {\n            var angle;\n            var matrix = this.helper.css(\"-webkit-transform\") ||\n                this.helper.css(\"-moz-transform\") ||\n                this.helper.css(\"-ms-transform\") ||\n                this.helper.css(\"-o-transform\") ||\n                this.helper.css(\"transform\");\n            if (matrix && matrix !== 'none')\n            {\n                var values = matrix.split('(')[1].split(')')[0].split(',');\n                var a = values[0];\n                var b = values[1];\n                angle = Math.round(Math.atan2(b, a) * (180 / Math.PI));\n            }\n            else\n            {\n                angle = 0;\n            }\n            return angle;\n        }\n    });\n\n    $.ui.plugin.add(\"rotatable\", \"snap\", {\n        rotate: function(event, ui)\n        {\n            var i = $(this).data(\"rotatable\"), o = i.options;\n            var angle = o.snap.angle ? o.snap.angle : 15;\n            if (!o.snap.angle)\n            {\n                return;\n            }\n            var snapTolerance = o.snap.tolerance ? o.snap.tolerance : 2;\n            var diff = Math.abs(ui.angle % angle);\n            if (diff === 0 || diff < snapTolerance || angle - diff < snapTolerance)\n            {\n                var newAngle = diff === 0 ? ui.angle : diff < snapTolerance ? ui.angle - diff : ui.angle + angle - diff;\n                ui.angle = newAngle;\n            }\n        }\n    });\n})(jQuery);\n"]],"start1":0,"start2":0,"length1":5041,"length2":11434}]],"length":11434,"saved":false}
